type ModerationDispute @entity{
    id: ID!
    timestampLastUpdated: BigInt!
    timestampLastRound: BigInt
    timestampLastAppeal: BigInt
    timestampLastAppealPossible: BigInt
    rulingFunded: BigInt
    currentRuling: BigInt
    finalRuling: BigInt
    moderationInfo: ModerationInfo!
}

type ModerationInfo @entity(immutable: true){
    id: ID!
    moderationType: BigInt!
    rulesUrl: String!
    message: String!
    messageBackup: String!
    reportedBy: UserHistory!
    askedBy: Bytes!
    deadline: BigInt
    timeout: BigInt!
    UserHistory: UserHistory!
    dispute: ModerationDispute @derivedFrom(field: "moderationInfo")
    reality: RealityCheck
}

type RealityCheck @entity{
    id: ID!
    currentAnswer: Bytes
    deadline: BigInt!
    timeServed: BigInt
    blocknumberLastUpdated: BigInt
    timestampLastUpdated: BigInt
    moderationInfo: ModerationInfo! @derivedFrom(field: "reality")
    dispute: String
}

type UserHistory @entity{
    id: ID!
    user: User!
    group: Group!
    timestampLastUpdated: BigInt!
    timestampParole: BigInt!
    countBrokeRulesOptimisticAndArbitrated: Int!
    countBrokeRulesArbitrated: Int!
    countReportsMade: Int!
    countReportsMadeAndResponded: Int!
    timestampLastReport: BigInt!
    moderation: [ModerationInfo!]! @derivedFrom(field: "UserHistory")
}

type User @entity(immutable: true){
    id: ID!
    username: String
    userID: String!
    history: [UserHistory!]! @derivedFrom(field: "user")
}

type Janny @entity{
    id: ID!
    group: Group!
    botAddress: Bytes
    blocknumberLastUpdatedSheriff: BigInt
    blocknumberLastUpdatedDeputySheriff: BigInt
    timestampLastUpdatedSheriff: BigInt
    timestampLastUpdatedDeputySheriff: BigInt
    sheriff: UserHistory
    deputySheriff: UserHistory
}

type Group @entity(immutable: true){
    id: ID!
    name: String
    platform: String!
    groupID: String!
    botAddress: Bytes!
    UserHistory: [UserHistory!]! @derivedFrom(field: "group")
}